 <!DOCTYPE html>
 <!-- http://cscilab.bc.edu/~shinw/wonseokshin/assignments/finalproject/index.php -->
<html>
 <head>
  <meta charset="UTF-8">
  <title>Final Project - Lisa Huang - Won Seok Shin</title>

  <style>
.bestbuytable {
	margin:0px;padding:0px;
	width:100%;
	box-shadow: 10px 10px 5px #888888;
	border:1px solid #000000;
	
	-moz-border-radius-bottomleft:0px;
	-webkit-border-bottom-left-radius:0px;
	border-bottom-left-radius:0px;
	
	-moz-border-radius-bottomright:0px;
	-webkit-border-bottom-right-radius:0px;
	border-bottom-right-radius:0px;
	
	-moz-border-radius-topright:0px;
	-webkit-border-top-right-radius:0px;
	border-top-right-radius:0px;
	
	-moz-border-radius-topleft:0px;
	-webkit-border-top-left-radius:0px;
	border-top-left-radius:0px;
}.bestbuytable table{
    border-collapse: collapse;
        border-spacing: 0;
	width:100%;
	height:100%;
	margin:0px;padding:0px;
}.bestbuytable tr:last-child td:last-child {
	-moz-border-radius-bottomright:0px;
	-webkit-border-bottom-right-radius:0px;
	border-bottom-right-radius:0px;
}
.bestbuytable table tr:first-child td:first-child {
	-moz-border-radius-topleft:0px;
	-webkit-border-top-left-radius:0px;
	border-top-left-radius:0px;
}
.bestbuytable table tr:first-child td:last-child {
	-moz-border-radius-topright:0px;
	-webkit-border-top-right-radius:0px;
	border-top-right-radius:0px;
}.bestbuytable tr:last-child td:first-child{
	-moz-border-radius-bottomleft:0px;
	-webkit-border-bottom-left-radius:0px;
	border-bottom-left-radius:0px;
}.bestbuytable tr:hover td{
	
}
.bestbuytable tr:nth-child(odd){ background-color:#ffff56; }
.bestbuytable tr:nth-child(even)    { background-color:#56aaff; }.bestbuytable td{
	vertical-align:middle;
	
	
	border:1px solid #000000;
	border-width:0px 1px 1px 0px;
	text-align:left;
	padding:7px;
	font-size:10px;
	font-family:Arial;
	font-weight:normal;
	color:#000000;
}.bestbuytable tr:last-child td{
	border-width:0px 1px 0px 0px;
}.bestbuytable tr td:last-child{
	border-width:0px 0px 1px 0px;
}.bestbuytable tr:last-child td:last-child{
	border-width:0px 0px 0px 0px;
}
.bestbuytable tr:first-child td{
		background:-o-linear-gradient(bottom, #000000 5%, #ffff56 100%);	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #000000), color-stop(1, #ffff56) );
	background:-moz-linear-gradient( center top, #000000 5%, #ffff56 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#000000", endColorstr="#ffff56");	background: -o-linear-gradient(top,#000000,ffff56);

	background-color:#000000;
	border:0px solid #000000;
	text-align:center;
	border-width:0px 0px 1px 1px;
	font-size:14px;
	font-family:Arial;
	font-weight:bold;
	color:#ffffff;
}
.bestbuytable tr:first-child:hover td{
	background:-o-linear-gradient(bottom, #000000 5%, #ffff56 100%);	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #000000), color-stop(1, #ffff56) );
	background:-moz-linear-gradient( center top, #000000 5%, #ffff56 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#000000", endColorstr="#ffff56");	background: -o-linear-gradient(top,#000000,ffff56);

	background-color:#000000;
}
.bestbuytable tr:first-child td:first-child{
	border-width:0px 0px 1px 0px;
}
.bestbuytable tr:first-child td:last-child{
	border-width:0px 0px 1px 1px;
}




    .radioshack {
	margin:0px;padding:0px;
	width:100%;
	box-shadow: 10px 10px 5px #888888;
	border:1px solid #000000;
	
	-moz-border-radius-bottomleft:0px;
	-webkit-border-bottom-left-radius:0px;
	border-bottom-left-radius:0px;
	
	-moz-border-radius-bottomright:0px;
	-webkit-border-bottom-right-radius:0px;
	border-bottom-right-radius:0px;
	
	-moz-border-radius-topright:0px;
	-webkit-border-top-right-radius:0px;
	border-top-right-radius:0px;
	
	-moz-border-radius-topleft:0px;
	-webkit-border-top-left-radius:0px;
	border-top-left-radius:0px;
}.radioshack table{
    border-collapse: collapse;
        border-spacing: 0;
	width:100%;
	height:100%;
	margin:0px;padding:0px;
}.radioshack tr:last-child td:last-child {
	-moz-border-radius-bottomright:0px;
	-webkit-border-bottom-right-radius:0px;
	border-bottom-right-radius:0px;
}
.radioshack table tr:first-child td:first-child {
	-moz-border-radius-topleft:0px;
	-webkit-border-top-left-radius:0px;
	border-top-left-radius:0px;
}
.radioshack table tr:first-child td:last-child {
	-moz-border-radius-topright:0px;
	-webkit-border-top-right-radius:0px;
	border-top-right-radius:0px;
}.radioshack tr:last-child td:first-child{
	-moz-border-radius-bottomleft:0px;
	-webkit-border-bottom-left-radius:0px;
	border-bottom-left-radius:0px;
}.radioshack tr:hover td{
	
}
.radioshack tr:nth-child(odd){ background-color:#ffaa56; }
.radioshack tr:nth-child(even)    { background-color:#ffffff; }.radioshack td{
	vertical-align:middle;
	
	
	border:1px solid #000000;
	border-width:0px 1px 1px 0px;
	text-align:left;
	padding:7px;
	font-size:10px;
	font-family:Arial;
	font-weight:normal;
	color:#000000;
}.radioshack tr:last-child td{
	border-width:0px 1px 0px 0px;
}.radioshack tr td:last-child{
	border-width:0px 0px 1px 0px;
}.radioshack tr:last-child td:last-child{
	border-width:0px 0px 0px 0px;
}
.radioshack tr:first-child td{
		background:-o-linear-gradient(bottom, #ff7f00 5%, #bf5f00 100%);	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #ff7f00), color-stop(1, #bf5f00) );
	background:-moz-linear-gradient( center top, #ff7f00 5%, #bf5f00 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#ff7f00", endColorstr="#bf5f00");	background: -o-linear-gradient(top,#ff7f00,bf5f00);

	background-color:#ff7f00;
	border:0px solid #000000;
	text-align:center;
	border-width:0px 0px 1px 1px;
	font-size:14px;
	font-family:Arial;
	font-weight:bold;
	color:#ffffff;
}
.radioshack tr:first-child:hover td{
	background:-o-linear-gradient(bottom, #ff7f00 5%, #bf5f00 100%);	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #ff7f00), color-stop(1, #bf5f00) );
	background:-moz-linear-gradient( center top, #ff7f00 5%, #bf5f00 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#ff7f00", endColorstr="#bf5f00");	background: -o-linear-gradient(top,#ff7f00,bf5f00);

	background-color:#ff7f00;
}
.radioshack tr:first-child td:first-child{
	border-width:0px 0px 1px 0px;
}
.radioshack tr:first-child td:last-child{
	border-width:0px 0px 1px 1px;
}



.target {
	margin:0px;padding:0px;
	width:100%;
	box-shadow: 10px 10px 5px #888888;
	border:1px solid #000000;
	
	-moz-border-radius-bottomleft:0px;
	-webkit-border-bottom-left-radius:0px;
	border-bottom-left-radius:0px;
	
	-moz-border-radius-bottomright:0px;
	-webkit-border-bottom-right-radius:0px;
	border-bottom-right-radius:0px;
	
	-moz-border-radius-topright:0px;
	-webkit-border-top-right-radius:0px;
	border-top-right-radius:0px;
	
	-moz-border-radius-topleft:0px;
	-webkit-border-top-left-radius:0px;
	border-top-left-radius:0px;
}.target table{
    border-collapse: collapse;
        border-spacing: 0;
	width:100%;
	height:100%;
	margin:0px;padding:0px;
}.target tr:last-child td:last-child {
	-moz-border-radius-bottomright:0px;
	-webkit-border-bottom-right-radius:0px;
	border-bottom-right-radius:0px;
}
.target table tr:first-child td:first-child {
	-moz-border-radius-topleft:0px;
	-webkit-border-top-left-radius:0px;
	border-top-left-radius:0px;
}
.target table tr:first-child td:last-child {
	-moz-border-radius-topright:0px;
	-webkit-border-top-right-radius:0px;
	border-top-right-radius:0px;
}.target tr:last-child td:first-child{
	-moz-border-radius-bottomleft:0px;
	-webkit-border-bottom-left-radius:0px;
	border-bottom-left-radius:0px;
}.target tr:hover td{
	
}
.target tr:nth-child(odd){ background-color:#ff5656; }
.target tr:nth-child(even)    { background-color:#ffffff; }.target td{
	vertical-align:middle;
	
	
	border:1px solid #000000;
	border-width:0px 1px 1px 0px;
	text-align:left;
	padding:7px;
	font-size:10px;
	font-family:Arial;
	font-weight:normal;
	color:#000000;
}.target tr:last-child td{
	border-width:0px 1px 0px 0px;
}.target tr td:last-child{
	border-width:0px 0px 1px 0px;
}.target tr:last-child td:last-child{
	border-width:0px 0px 0px 0px;
}
.target tr:first-child td{
		background:-o-linear-gradient(bottom, #bf0000 5%, #bf0000 100%);	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #bf0000), color-stop(1, #bf0000) );
	background:-moz-linear-gradient( center top, #bf0000 5%, #bf0000 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#bf0000", endColorstr="#bf0000");	background: -o-linear-gradient(top,#bf0000,bf0000);

	background-color:#bf0000;
	border:0px solid #000000;
	text-align:center;
	border-width:0px 0px 1px 1px;
	font-size:14px;
	font-family:Arial;
	font-weight:bold;
	color:#ffffff;
}
.target tr:first-child:hover td{
	background:-o-linear-gradient(bottom, #bf0000 5%, #bf0000 100%);	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #bf0000), color-stop(1, #bf0000) );
	background:-moz-linear-gradient( center top, #bf0000 5%, #bf0000 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#bf0000", endColorstr="#bf0000");	background: -o-linear-gradient(top,#bf0000,bf0000);

	background-color:#bf0000;
}
.target tr:first-child td:first-child{
	border-width:0px 0px 1px 0px;
}
.target tr:first-child td:last-child{
	border-width:0px 0px 1px 1px;
}
  </style>
 </head>


 <body>
 	<form method="get">
 		<fieldset><legend>Crawl From Base URL</legend>
            Base URL: <input type="text" name="url_base_to_crawl"><br>
            Supervised Search: <input type="text" name="best_buy_search_term"><br>
	 		<input type="submit" name="submitcrawl" value="Start Crawling">
 		</fieldset>
 	</form><br>



 	 <?php

 	 if(isset($_GET['submitcrawl']) && isset($_GET['url_base_to_crawl'])){
            //scraping product listings from bestbuy.com
            if(isset($_GET['best_buy_search_term'])){
                $best_buy_url = 'http://www.bestbuy.com/site/searchpage.jsp?keys=keys&ks=960&usc=All%20Categories&iht=y&list=n&qp=soldby_facet%3DSold%20By~Best%20Buy&sp=&nrp=15&cp=1&sc=Global&type=page&id=pcat17071&_dyncharset=UTF-8&st=' . $_GET['best_buy_search_term'];
                $best_buy_html = fread_url($best_buy_url);
                $item_listing_begin_tag   = '</div><div class="list-item"';
                $pos = 0;


                echo "<div class='bestbuytable'><table border='1'>";
                echo "<caption>From Best Buy</caption>";

                //Table Headers
                echo "<tr>";
                    echo "<td>Image</td>";
                    echo "<td> Name / Price / Description</td>";
                echo "</tr>";
                while(true){
                    //Search for the next product listing, if it does not exist, break from while loop 
                    $pos = strpos($best_buy_html, $item_listing_begin_tag, $pos);            
                    if ($pos === false) {
                        //echo "The string was not found";
                        break;
                    } 


                    //extract name, picture, price, description
                    //data-name="..."
                    $pos_name_beginning = strpos($best_buy_html, "data-name=", $pos);
                    $pos_name_beginning = $pos_name_beginning + strlen("data-name=") + 1;

                    $pos_name_ending = strpos($best_buy_html, "data-pricing-type=", $pos_name_beginning);
                    $pos_name_ending = $pos_name_ending - 2;
                    $name_string_length = $pos_name_ending - $pos_name_beginning ;
                    $name = substr($best_buy_html, $pos_name_beginning, $name_string_length);

                    //echo "name beg: $pos_name_beginning<br>";
                    //echo "name end: $pos_name_ending<br>";
                    //echo "name length: $name_string_length<br>";

                    //data-price="..."
                    $pos_price_beginning = strpos($best_buy_html, "data-price=", $pos);
                    $pos_price_beginning = $pos_price_beginning + strlen("data-price=") + 1;

                    $pos_price_ending = strpos($best_buy_html, '>', $pos_price_beginning);
                    $pos_price_ending = $pos_price_ending - 2;
                    $price_string_length = $pos_price_ending - $pos_price_beginning;
                    $price = substr($best_buy_html, $pos_price_beginning, $price_string_length);
                    //echo "price beg: $pos_price_beginning<br>";
                    //echo "price end: $pos_price_ending<br>";
                    //echo "price length: $price_string_length<br>";

                    $pos_link_beginning = strpos($best_buy_html, "<a href=", $pos);
                    $pos_link_beginning = $pos_link_beginning + strlen("<a href=") + 1;

                    $pos_link_ending = strpos($best_buy_html, "\"" , $pos_link_beginning);
                    $pos_link_ending = $pos_link_ending - 2;
                    $link_string_length = $pos_link_ending - $pos_link_beginning;
                    $link = "http://www.bestbuy.com" . substr($best_buy_html, $pos_link_beginning, $link_string_length);

                    //Image
                    $pos_img_beginning = strpos($best_buy_html, "<img src=", $pos);
                    $pos_img_beginning = $pos_img_beginning + strlen("<img src=") + 1;

                    $pos_img_ending = strpos($best_buy_html, "\"", $pos_img_beginning);
                    $pos_img_ending = $pos_img_ending;
                    $img_string_length = $pos_img_ending - $pos_img_beginning;
                    $img = substr($best_buy_html, $pos_img_beginning, $img_string_length);
                    //echo "image beg: $pos_img_beginning<br>";
                    //echo "image end: $pos_img_ending<br>";
                    //echo "image length: $img_string_length<br>";

                    //Description
                    $pos_description_beginning = strpos($best_buy_html, "<div class=\"short-description\">", $pos);
                    $pos_description_beginning = $pos_description_beginning + strlen("<div class=\"short-description\">");

                    $pos_description_ending = strpos($best_buy_html, "</div>", $pos_description_beginning);
                    $pos_description_ending = $pos_description_ending;
                    $description_string_length = $pos_description_ending - $pos_description_beginning;
                    $description = substr($best_buy_html, $pos_description_beginning, $description_string_length);
                    
                    // Provides: <body text='black'>
                    $description = str_replace("<li>", "", $description);
                    $description = str_replace("<ul>", "", $description);
                    $description = str_replace("<ol>", "", $description);
                    $description = str_replace("</li>", "<br>", $description);

                    //echo "description beg: $pos_description_beginning<br>";
                    //echo "description end: $pos_description_ending<br>";
                    //echo "description length: $description_string_length<br>";
                    
                    // Note use of ===.  Simply == would not work as expected
                    // because the position of 'a' was the 0th (first) character.
                    //echo "The string was found and exists at position $pos.<br>";
                    echo "<tr>";
                        echo "<td><img src='$img' alt='thumbnail' height='100' width='100'></td>";

                        echo "<td>";
                        echo "<b>$name</b><br>";
                        echo "<i>  <a href='$link'>$link</a>         </i><br><br>";

                        echo "Price: $price<br><br>";
                        echo "$description";
                        echo "</td>";
                    echo "</tr>";


                    $pos = $pos_description_ending;                    
                }
                echo "</table></div>";


                //RADIOSHACK Product Listings - http://www.radioshack.com/search?q=phone
                $radioshack_url = 'http://www.radioshack.com/search?q=' . $_GET['best_buy_search_term'];
                $radioshack_html = fread_url($radioshack_url);
                $item_listing_begin_tag   = "<a class=\"name-link\" href=\"";

                $pos = 0;


                echo "<div class='radioshack'><table border='1'>";
                echo "<caption>From Radioshack</caption>";

                //Table Headers
                echo "<tr>";
                    echo "<td>Image</td>";
                    echo "<td> Name / Price / Description</td>";
                echo "</tr>";
                while(true){
                    //Search for the next product listing, if it does not exist, break from while loop 
                    $pos = strpos($radioshack_html, $item_listing_begin_tag, $pos);            
                    if ($pos === false) {
                        //echo "The string was not found";
                        break;
                    } 

                    //get link to item
                    $pos += strlen($item_listing_begin_tag);
                    $pos_link_ending = strpos($radioshack_html, "\"" , $pos);
                    $pos_link_ending = $pos_link_ending;

                    $item_link_length = $pos_link_ending - $pos;
                    $item_link = substr($radioshack_html, $pos, $item_link_length);
                    
                    //load html of item page
                    $item_html = fread_url($item_link);
                    //scrape info
                    	//title - <li><span class="last">Boost Mobile LG Volt No-Contract Phone</span></li>
                    $title_beginning_pos = strpos($item_html, "<li><span class=\"last\">" , 0);
                    $title_beginning_pos += strlen("<li><span class=\"last\">");
                    $title_ending_pos = strpos($item_html, "</span>" , $title_beginning_pos);
                    $title_length = $title_ending_pos - $title_beginning_pos;
                    $title = substr($item_html, $title_beginning_pos, $title_length);
                    	//link - $item_link
                    	//price - 
                    	//<span class="map-sale-price">
//						$148.00
//					</span>

                    $price_beginning_pos = strpos($item_html, "price\">" , 0);
                    $price_beginning_pos += strlen("price\">");
                    $price_beginning_pos = strpos($item_html, "$" , $price_beginning_pos);
                    $price_beginning_pos += 1;

                    $price_ending_pos = strpos($item_html, " " , $price_beginning_pos);
                    $price_length = $price_ending_pos - $price_beginning_pos;
                    $price = substr($item_html, $price_beginning_pos, $price_length);


                                        	//description

//    				<div class="tab-content">
//					Power and speed redefined.
//					Enjoy the power of an Android smartphone, without a contract, with the Boost Mobile LG Volt No-Contract Phone.  It's powered by Android 4.4 and a 1.2GHz quad-core processor, so you'll be able to surf the Web, stream videos and share your memories faster than ever. Plus, Google Play gives you access to hundreds of thousands of books, music, movies, TV shows and apps.
//					<ul><li>1.2GHz quad-core processor delivers seamless performance and power</li><li>Android 4.4 (KitKat) offers a more polished design, improved performance and new features</li><li>Experience all of your favorite media on the 4.7" qHD IPS display with durable Corning Gorilla Glass</li><li>QSlide Function gives you quick access to videos, calendars, your browser and more</li><li>Knock Code gives you quick, secure access to your phone with your personalized tap pattern</li><li>Powerful, removable 3000mAh battery delivers up to 24 hours of talk time*</li><li>Built-in 8MP rear-facing camera for crisp, sharp photos and 1080p HD video</li><li>Video chat using the 1.3-megapixel front-facing camera</li><li>Guest Mode gives you peace of mind when sharing your phone with others</li><li>Turn your LG Volt into a remote control for your multiple-room, home TV and cable box with QRemote</li><li>At Google Play, you can browse and download thousands of free and paid apps from around the world</li><li>One-click access to Facebook, Twitter and more</li><li>Wi-Fi connectivity: 802.11 b/g/n; Bluetooth connectivity: 4.0</li><li>8GB storage capacity expandable to 32GB via microSD memory cards (not included)</li></ul>
//					<div class="right-description">

                    $description_beginning_pos = strpos($item_html, "<div class=\"descr-long\">" , 0);
                    $description_beginning_pos += strlen("<div class=\"descr-long\">");					                    
                    $description_ending_pos = strpos($item_html, "</div" , $description_beginning_pos);
                    $description_length = $description_ending_pos - $description_beginning_pos;
                    $description = substr($item_html, $description_beginning_pos, $description_length);


                    	//image
//<img class="productthumbnail" src="http://demandware.edgesuite.net/sits_pod26/dw/image/v2/AASR_PRD/on/demandware.static/Sites-radioshack-Site/Sites-master-catalog/default/v1429999232272/images/01709883_01.jpg?sw=89&amp;sh=89&amp;sm=fit" alt="Boost Mobile LG Volt No-Contract Phone, " title="Boost Mobile LG Volt No-Contract PhoneBoost Mobile LG Volt No-Contract Phone, " data-lgimg='{"url":"http://demandware.edgesuite.net/sits_pod26/dw/image/v2/AASR_PRD/on/demandware.static/Sites-radioshack-Site/Sites-master-catalog/default/v1429999232272/images/01709883_01.jpg?sw=350&amp;sh=350&amp;sm=fit", "title":"Boost Mobile LG Volt No-Contract Phone, ", "alt":"Boost Mobile LG Volt No-Contract Phone, ", "hires":"http://demandware.edgesuite.net/aasr_prd/on/demandware.static/Sites-radioshack-Site/Sites-master-catalog/default/v1429999232272/images/01709883_01.jpg"}'/>								 
//							</a>

                    $image_beginning_pos = strpos($item_html, "<a class=\"mainimagezoom\" href=" , 0);
                    $image_beginning_pos += strlen("<a class=\"mainimagezoom\" href=");					    
                    $image_ending_pos = strpos($item_html, " " , $image_beginning_pos);
                    $image_length = $image_ending_pos - $image_beginning_pos;
                    $image = substr($item_html, $image_beginning_pos, $image_length);

                    //add to table
                    //continue
                    //$description = str_replace("<li>", "", $description);
                    //$description = str_replace("<ul>", "", $description);
                    //$description = str_replace("<ol>", "", $description);
                    //$description = str_replace("</li>", "<br>", $description);

                    //echo "description beg: $pos_description_beginning<br>";
                    //echo "description end: $pos_description_ending<br>";
                    //echo "description length: $description_string_length<br>";
                    
                    // Note use of ===.  Simply == would not work as expected
                    // because the position of 'a' was the 0th (first) character.
                    //echo "The string was found and exists at position $pos.<br>";
                    echo "<tr>";
                        echo "<td><img src='$image' alt='thumbnail' height='100' width='100'></td>";

                        echo "<td>";
                        echo "<b>$title</b><br>";
                        echo "<i>  <a href='$item_link'>$item_link</a>         </i><br><br>";

                        echo "Price: $price<br><br>";
                        echo "$description";
                        echo "</td>";
                    echo "</tr>";


                    $pos = $pos_link_ending;                 
                }
                echo "</table></div>";
                //RADIOSHACK Product Listings



                //TARGET PRODUCT LISTINGS
                //www.target.com/s?searchTerm=paper
                $target_url = 'www.target.com/s?searchTerm=' . $_GET['best_buy_search_term'];
                $target_html = fread_url($target_url);
                $item_listing_begin_tag   = "<div class=\"tileImage\">";

                $pos = 0;


                echo "<div class='target'><table border='1'>";
                echo "<caption>From Target</caption>";

                //Table Headers
                echo "<tr>";
                    echo "<td>Image</td>";
                    echo "<td> Name / Price / Description</td>";
                echo "</tr>";
                while(true){
                    //Search for the next product listing, if it does not exist, break from while loop 
                    $pos = strpos($target_html, $item_listing_begin_tag, $pos);            
                    if ($pos === false) {
                        //echo "The string was not found";
                        break;
                    } 

                    //get link to item
                    $pos_link_beginning = strpos($target_html, "<a href=\"" , $pos);
                    $pos_link_beginning += strlen("<a href=\"");
                    $pos_link_ending = strpos($target_html, "\"" , $pos_link_beginning);

                    $item_link_length = $pos_link_ending - $pos_link_beginning;
                    $item_link = substr($target_html, $pos_link_beginning, $item_link_length);

                    //scrape info
                    	//title - <li><span class="last">Boost Mobile LG Volt No-Contract Phone</span></li>
                    $title_beginning_pos = strpos($target_html, "title=\"" , $pos_link_ending);
                    $title_beginning_pos += strlen("title=\"");
                    $title_ending_pos = strpos($target_html, "\"" , $title_beginning_pos);
                    $title_length = $title_ending_pos - $title_beginning_pos;
                    $title = substr($target_html, $title_beginning_pos, $title_length);
                    	//link - $item_link
                    	//price - 
                    	//<span class="map-sale-price">
//						$148.00
//					</span>

                    $price_beginning_pos = strpos($target_html, "<p class=\"price price-label\">" , $title_ending_pos);
                    $price_beginning_pos += strlen("<p class=\"price price-label\">");
                    $price_beginning_pos = strpos($target_html, "$" , $price_beginning_pos);
                    $price_beginning_pos += 1;

                    	//if $ location is greater than the next item
                    	$pos_next_item = strpos($target_html, $item_listing_begin_tag , $pos_link_ending);
                    	if($price_beginning_pos > $pos_next_item && $pos_next_item !== false){
                    		//no price is displayed
		                    $price = 'unknown';
                    	}
                    	else{
		                    $price_ending_pos = strpos($target_html, " " , $price_beginning_pos);
		                    $price_length = $price_ending_pos - $price_beginning_pos;
		                    $price = substr($target_html, $price_beginning_pos, $price_length);
                    	}






                                        	//description

//    				<div class="tab-content">
//					Power and speed redefined.
//					Enjoy the power of an Android smartphone, without a contract, with the Boost Mobile LG Volt No-Contract Phone.  It's powered by Android 4.4 and a 1.2GHz quad-core processor, so you'll be able to surf the Web, stream videos and share your memories faster than ever. Plus, Google Play gives you access to hundreds of thousands of books, music, movies, TV shows and apps.
//					<ul><li>1.2GHz quad-core processor delivers seamless performance and power</li><li>Android 4.4 (KitKat) offers a more polished design, improved performance and new features</li><li>Experience all of your favorite media on the 4.7" qHD IPS display with durable Corning Gorilla Glass</li><li>QSlide Function gives you quick access to videos, calendars, your browser and more</li><li>Knock Code gives you quick, secure access to your phone with your personalized tap pattern</li><li>Powerful, removable 3000mAh battery delivers up to 24 hours of talk time*</li><li>Built-in 8MP rear-facing camera for crisp, sharp photos and 1080p HD video</li><li>Video chat using the 1.3-megapixel front-facing camera</li><li>Guest Mode gives you peace of mind when sharing your phone with others</li><li>Turn your LG Volt into a remote control for your multiple-room, home TV and cable box with QRemote</li><li>At Google Play, you can browse and download thousands of free and paid apps from around the world</li><li>One-click access to Facebook, Twitter and more</li><li>Wi-Fi connectivity: 802.11 b/g/n; Bluetooth connectivity: 4.0</li><li>8GB storage capacity expandable to 32GB via microSD memory cards (not included)</li></ul>
//					<div class="right-description">
                	$item_html = fread_url($item_link);


                    $description_beginning_pos = strpos($item_html, "<span itemprop=\"description\">" , 0);
                    if($description_beginning_pos === false){
	                    $description_beginning_pos = strpos($item_html, "<ul class=\"normal-list\">" , 0);
                        $description_ending_pos = strpos($item_html, "</ul>" , $description_beginning_pos);
 						$description_ending_pos += strlen("</ul>");	      
                        $description_length = $description_ending_pos - $description_beginning_pos;
                   		$description = substr($item_html, $description_beginning_pos, $description_length);                         	
                    }
                    else{
                    	$description_beginning_pos += strlen("<span itemprop=\"description\">");
                        $description_ending_pos = strpos($item_html, "</span>" , $description_beginning_pos);
                        $description_length = $description_ending_pos - $description_beginning_pos;
                   		$description = substr($item_html, $description_beginning_pos, $description_length);                         	


	                    $description_beginning_pos = strpos($item_html, "<ul class=\"normal-list\">" , 0);
                        $description_ending_pos = strpos($item_html, "</ul>" , $description_beginning_pos);
 						$description_ending_pos += strlen("</ul>");	      
                        $description_length = $description_ending_pos - $description_beginning_pos;
                   		$description = $description . "\n" . substr($item_html, $description_beginning_pos, $description_length);   
                    }




                    	//image
//<img class="productthumbnail" src="http://demandware.edgesuite.net/sits_pod26/dw/image/v2/AASR_PRD/on/demandware.static/Sites-radioshack-Site/Sites-master-catalog/default/v1429999232272/images/01709883_01.jpg?sw=89&amp;sh=89&amp;sm=fit" alt="Boost Mobile LG Volt No-Contract Phone, " title="Boost Mobile LG Volt No-Contract PhoneBoost Mobile LG Volt No-Contract Phone, " data-lgimg='{"url":"http://demandware.edgesuite.net/sits_pod26/dw/image/v2/AASR_PRD/on/demandware.static/Sites-radioshack-Site/Sites-master-catalog/default/v1429999232272/images/01709883_01.jpg?sw=350&amp;sh=350&amp;sm=fit", "title":"Boost Mobile LG Volt No-Contract Phone, ", "alt":"Boost Mobile LG Volt No-Contract Phone, ", "hires":"http://demandware.edgesuite.net/aasr_prd/on/demandware.static/Sites-radioshack-Site/Sites-master-catalog/default/v1429999232272/images/01709883_01.jpg"}'/>								 
//							</a>


                    $image_beginning_pos = strpos($item_html, "<img itemprop=\"image\"", 0);
                    $image_beginning_pos = strpos($item_html, "src=\"", $image_beginning_pos);
                    $image_beginning_pos += strlen("src=\"");					    
                    $image_ending_pos = strpos($item_html, "\"" , $image_beginning_pos);
                    $image_length = $image_ending_pos - $image_beginning_pos;
                    $image = substr($item_html, $image_beginning_pos, $image_length);
                    

                    //add to table
                    //continue
                    //$description = str_replace("<li>", "", $description);
                    //$description = str_replace("<ul>", "", $description);
                    //$description = str_replace("<ol>", "", $description);
                    //$description = str_replace("</li>", "<br>", $description);

                    //echo "description beg: $pos_description_beginning<br>";
                    //echo "description end: $pos_description_ending<br>";
                    //echo "description length: $description_string_length<br>";
                    
                    // Note use of ===.  Simply == would not work as expected
                    // because the position of 'a' was the 0th (first) character.
                    //echo "The string was found and exists at position $pos.<br>";
                    echo "<tr>";
                        echo "<td><img src='$image' alt='thumbnail' height='100' width='100'></td>";

                        echo "<td>";
                        echo "<b>$title</b><br>";
                        echo "<i>  <a href='$item_link'>$item_link</a>         </i><br><br>";

                        echo "Price: $price<br><br>";
                        echo "$description";
                        echo "</td>";
                    echo "</tr>";


                    $pos = $pos_link_ending;                 
                }
                echo "</table></div>";
                //TARGET PRODUCT LISTINGS



                //AMAZON PRODUCT LISTINGS
                $amazon_url = 'http://www.amazon.com/s/ref=sr_ex_n_0?fst=as%3Aoff&rh=i%3Aaps%2Ck%3Ashoes&keywords=' . $_GET['best_buy_search_term'];
                $amazon_html = fread_url($amazon_url);
                $item_listing_begin_tag   = '<li id="result_';
                $pos = 0;


                echo "<div><table border='1'>";
                echo "<caption>From Amazon</caption>";

                //Table Headers
                echo "<tr>";
                    echo "<td>Image</td>";
                    echo "<td> Name / Price / Description</td>";
                echo "</tr>";
                while($item_listing_begin_tag){
                    //Search for the next product listing, if it does not exist, break from while loop 
                    $pos = strpos($amazon_html, $item_listing_begin_tag, $pos);            
                    if ($pos === false) {
                        //echo "The string was not found";
                        break;
                    } 


                    //extract name, picture, price, description
                    //data-name="..."
                    $pos_name_beginning = strpos($amazon_html, 'a-text-normal">', $pos);
                    $pos_name_beginning = $pos_name_beginning + strlen('a-text-normal">');

                    $pos_name_ending = strpos($amazon_html, '</h2></a>', $pos_name_beginning);
                    $pos_name_ending = $pos_name_ending;
                    $name_string_length = $pos_name_ending - $pos_name_beginning ;
                    $name = substr($amazon_html, $pos_name_beginning, $name_string_length);

                    //echo "name beg: $pos_name_beginning<br>";
                    //echo "name end: $pos_name_ending<br>";
                    //echo "name length: $name_string_length<br>";

                    //data-price="..."
                    $pos_price_beginning = strpos($amazon_html, '<span class="a-size-base a-color-price s-price a-text-bold">', $pos);
                    $pos_price_beginning = $pos_price_beginning + strlen('<span class="a-size-base a-color-price s-price a-text-bold">');

                    $pos_price_ending = strpos($amazon_html, '</span></a>', $pos_price_beginning);
                    $pos_price_ending = $pos_price_ending;
                    $price_string_length = $pos_price_ending - $pos_price_beginning;
                    $price = substr($amazon_html, $pos_price_beginning, $price_string_length);
                    //echo "price beg: $pos_price_beginning<br>";
                    //echo "price end: $pos_price_ending<br>";
                    //echo "price length: $price_string_length<br>";

                    $pos_link_beginning = strpos($amazon_html, '<a class="a-link-normal a-text-normal" href=', $pos);
                    $pos_link_beginning = $pos_link_beginning + strlen("<a class='a-link-normal a-text-normal' href=") + 1;

                    $pos_link_ending = strpos($amazon_html, '">' , $pos_link_beginning);
                    $pos_link_ending = $pos_link_ending;
                    $link_string_length = $pos_link_ending - $pos_link_beginning;
                    $link = /*"http://www.amazon.com" . */substr($amazon_html, $pos_link_beginning, $link_string_length);

                    //Image
                    $pos_img_beginning = strpos($amazon_html, '<img alt="Product Details" src="', $pos);
                    $pos_img_beginning = $pos_img_beginning + strlen('<img alt="Product Details" src="');

                    $pos_img_ending = strpos($amazon_html, '" onload="', $pos_img_beginning);
                    $pos_img_ending = $pos_img_ending;
                    $img_string_length = $pos_img_ending - $pos_img_beginning;
                    $img = substr($amazon_html, $pos_img_beginning, $img_string_length);
                    //echo "image beg: $pos_img_beginning<br>";
                    //echo "image end: $pos_img_ending<br>";
                    //echo "image length: $img_string_length<br>";
                    /*
                    //Description
                    $pos_description_beginning = strpos($amazon_html, 'Product Description</span><br><span class="a-size-small a-color-secondary">', $pos);
                    $pos_description_beginning = $pos_description_beginning + strlen('Product Description</span><br><span class="a-size-small a-color-secondary">');

                    $pos_description_ending = strpos($amazon_html,'</span></div><div class="a-row a-spacing-mini"><div class="a-row a-spacing-mini">', $pos_description_beginning);
                    $pos_description_ending = $pos_description_ending;
                    $description_string_length = $pos_description_ending - $pos_description_beginning;
                    $description = substr($amazon_html, $pos_description_beginning, $description_string_length);
                    
                    // Provides: <body text='black'>
                    $description = str_replace("<li>", "", $description);
                    $description = str_replace("<ul>", "", $description);
                    $description = str_replace("<ol>", "", $description);
                    $description = str_replace("</li>", "<br>", $description);

                    //echo "description beg: $pos_description_beginning<br>";
                    //echo "description end: $pos_description_ending<br>";
                    //echo "description length: $description_string_length<br>";
                    */
                    // Note use of ===.  Simply == would not work as expected
                    // because the position of 'a' was the 0th (first) character.
                    //echo "The string was found and exists at position $pos.<br>";
                    echo "<tr>";
                        echo "<td><img src='$img' alt='thumbnail'></td>";

                        echo "<td>";
                        echo "<b>$name</b><br>";
                        echo "<i>  <a href='$link'>$link</a>         </i><br><br>";

                        echo "Price: $price<br><br>";
                        //echo "$description";
                        echo "</td>";
                    echo "</tr>";


                    $pos = $pos_img_ending;                    
                }
                echo "</table></div>";
                //AMAZON PRODUCT LISTINGS

                //MACY'S PRODUCT LISTING
                $macys_url = 'http://www1.macys.com/shop/search?keyword=' . $_GET['best_buy_search_term'];
                $macys_html = fread_url($macys_url);
                $item_listing_begin_tag   = 'productThumbnailJSON';
                $pos = 0;


                echo "<div><table border='1'>";
                echo "<caption>From Macy's</caption>";

                //Table Headers
                echo "<tr>";
                    echo "<td>Image</td>";
                    echo "<td> Name / Price / Description</td>";
                echo "</tr>";
                while(true){
                    //Search for the next product listing, if it does not exist, break from while loop 
                    $pos = strpos($macys_html, $item_listing_begin_tag, $pos);            
                    if ($pos === false) {
                        //echo "The string was not found";
                        break;
                    } 


                    //extract name, picture, price, description
                    //data-name="..."
                    $pos_name_beginning = strpos($macys_html, "title=", $pos);
                    $pos_name_beginning = $pos_name_beginning + strlen("title=") + 1;

                    $pos_name_ending = strpos($macys_html, "alt=", $pos_name_beginning);
                    $pos_name_ending = $pos_name_ending - 2;
                    $name_string_length = $pos_name_ending - $pos_name_beginning ;
                    $name = substr($macys_html, $pos_name_beginning, $name_string_length);

                    //echo "name beg: $pos_name_beginning<br>";
                    //echo "name end: $pos_name_ending<br>";
                    //echo "name length: $name_string_length<br>";

                    //data-price="..."
                    $pos_price_beginning = strpos($macys_html, 'Reg. ', $pos);
                    $pos_price_beginning = $pos_price_beginning + strlen('Reg. ');

                    $pos_price_ending = strpos($macys_html, '</span><br />', $pos_price_beginning);
                    $pos_price_ending = $pos_price_ending;
                    $price_string_length = $pos_price_ending - $pos_price_beginning;
                    $price = substr($macys_html, $pos_price_beginning, $price_string_length);
                    //echo "price beg: $pos_price_beginning<br>";
                    //echo "price end: $pos_price_ending<br>";
                    //echo "price length: $price_string_length<br>";

                    $pos_link_beginning = strpos($macys_html, '<a href="', $pos);
                    $pos_link_beginning = $pos_link_beginning + strlen('<a href="');

                    $pos_link_ending = strpos($macys_html, '" class=' , $pos_link_beginning);
                    $pos_link_ending = $pos_link_ending;
                    $link_string_length = $pos_link_ending - $pos_link_beginning;
                    $link = "http://www1.macys.com" . substr($macys_html, $pos_link_beginning, $link_string_length);

                    //Image
                    $pos_img_beginning = strpos($macys_html, 'data-src="', $pos);
                    $pos_img_beginning = $pos_img_beginning + strlen('data-src="');

                    $pos_img_ending = strpos($macys_html, '"', $pos_img_beginning);
                    $pos_img_ending = $pos_img_ending;
                    $img_string_length = $pos_img_ending - $pos_img_beginning;
                    $img = substr($macys_html, $pos_img_beginning, $img_string_length);
                    //echo "image beg: $pos_img_beginning<br>";
                    //echo "image end: $pos_img_ending<br>";
                    //echo "image length: $img_string_length<br>";

                    //Description
                    /*
                    $pos_description_ending = strpos($best_buy_html, "</div>", $pos_description_beginning);
                    $pos_description_ending = $pos_description_ending;
                    $description_string_length = $pos_description_ending - $pos_description_beginning;
                    $description = substr($best_buy_html, $pos_description_beginning, $description_string_length);
                    
                    // Provides: <body text='black'>
                    $description = str_replace("<li>", "", $description);
                    $description = str_replace("<ul>", "", $description);
                    $description = str_replace("<ol>", "", $description);
                    $description = str_replace("</li>", "<br>", $description);
                    */
                    //echo "description beg: $pos_description_beginning<br>";
                    //echo "description end: $pos_description_ending<br>";
                    //echo "description length: $description_string_length<br>";
                    
                    // Note use of ===.  Simply == would not work as expected
                    // because the position of 'a' was the 0th (first) character.
                    //echo "The string was found and exists at position $pos.<br>";
                    echo "<tr>";
                        echo "<td><img src='$img' alt='thumbnail'></td>";

                        echo "<td>";
                        echo "<b>$name</b><br>";
                        echo "<i>  <a href='$link'>$link</a>         </i><br><br>";

                        echo "Price: $price<br><br>";
                        //echo "$description";
                        echo "</td>";
                    echo "</tr>";


                    $pos = $pos_img_ending;                    
                }
                echo "</table></div>";
                //MACY'S PRODUCT LISTING


                //NORDSTROM'S PRODUCT LISTING
                                $nord_url = 'http://shop.nordstrom.com/sr?origin=keywordsearch&contextualcategoryid=2375500&keyword=' . $_GET['best_buy_search_term'];
                $nord_html = fread_url($nord_url);
                $item_listing_begin_tag   = '<span class="ada-hidden" id="ada-title">';
                $pos = 0;


                echo "<div class='nordtable'><table border='1'>";
                echo "<caption>From Nordstrom's</caption>";

                //Table Headers
                echo "<tr>";
                    echo "<td>Image</td>";
                    echo "<td> Name / Price / Description</td>";
                echo "</tr>";
                while(true){
                    //Search for the next product listing, if it does not exist, break from while loop 
                    $pos = strpos($nord_html, $item_listing_begin_tag, $pos);            
                    if ($pos === false) {
                        //echo "The string was not found";
                        break;
                    } 


                    //extract name, picture, price, description
                    //data-name="..."
                    $pos_name_beginning = strpos($nord_html, 'class="title">', $pos);
                    $pos_name_beginning = $pos_name_beginning + strlen('class="title">');

                    $pos_name_ending = strpos($nord_html, '</a><span class="price', $pos_name_beginning);
                    $pos_name_ending = $pos_name_ending;
                    $name_string_length = $pos_name_ending - $pos_name_beginning ;
                    $name = substr($nord_html, $pos_name_beginning, $name_string_length);

                    //echo "name beg: $pos_name_beginning<br>";
                    //echo "name end: $pos_name_ending<br>";
                    //echo "name length: $name_string_length<br>";

                    //data-price="..."
                    $pos_price_beginning = strpos($nord_html, '<span class="price regular">', $pos);
                    $pos_price_beginning = $pos_price_beginning + strlen('<span class="price regular">');

                    $pos_price_ending = strpos($nord_html, '</span>', $pos_price_beginning);
                    $pos_price_ending = $pos_price_ending;
                    $price_string_length = $pos_price_ending - $pos_price_beginning;
                    $price = substr($nord_html, $pos_price_beginning, $price_string_length);
                    //echo "price beg: $pos_price_beginning<br>";
                    //echo "price end: $pos_price_ending<br>";
                    //echo "price length: $price_string_length<br>";

                    $pos_link_beginning = strpos($nord_html, '" href="', $pos);
                    $pos_link_beginning = $pos_link_beginning + strlen('" href="');

                    $pos_link_ending = strpos($nord_html, '" class="title">' , $pos_link_beginning);
                    $pos_link_ending = $pos_link_ending;
                    $link_string_length = $pos_link_ending - $pos_link_beginning;
                    $link = "http://shop.nordstrom.com" . substr($nord_html, $pos_link_beginning, $link_string_length);

                    //Image
                    $pos_img_beginning = strpos($nord_html, 'data-original="', $pos);
                    $pos_img_beginning = $pos_img_beginning + strlen('data-original="');

                    $pos_img_ending = strpos($nord_html, '" />', $pos_img_beginning);
                    $pos_img_ending = $pos_img_ending;
                    $img_string_length = $pos_img_ending - $pos_img_beginning;
                    $img = substr($nord_html, $pos_img_beginning, $img_string_length);
                    //echo "image beg: $pos_img_beginning<br>";
                    //echo "image end: $pos_img_ending<br>";
                    //echo "image length: $img_string_length<br>";

                    //Description
                    /*
                    $pos_description_ending = strpos($best_buy_html, "</div>", $pos_description_beginning);
                    $pos_description_ending = $pos_description_ending;
                    $description_string_length = $pos_description_ending - $pos_description_beginning;
                    $description = substr($best_buy_html, $pos_description_beginning, $description_string_length);
                    
                    // Provides: <body text='black'>
                    $description = str_replace("<li>", "", $description);
                    $description = str_replace("<ul>", "", $description);
                    $description = str_replace("<ol>", "", $description);
                    $description = str_replace("</li>", "<br>", $description);
                    */
                    //echo "description beg: $pos_description_beginning<br>";
                    //echo "description end: $pos_description_ending<br>";
                    //echo "description length: $description_string_length<br>";
                    
                    // Note use of ===.  Simply == would not work as expected
                    // because the position of 'a' was the 0th (first) character.
                    //echo "The string was found and exists at position $pos.<br>";
                    echo "<tr>";
                        echo "<td><img src='$img' alt='thumbnail'></td>";

                        echo "<td>";
                        echo "<b>$name</b><br>";
                        echo "<i>  <a href='$link'>$link</a>         </i><br><br>";

                        echo "Price: $price<br><br>";
                        //echo "$description";
                        echo "</td>";
                    echo "</tr>";


                    $pos = $pos_img_ending;                    
                }
                echo "</table></div>";
                //NORDSTROM'S PRODUCT LISTING

            }

        //uncomment the following block to search for some hyperlinks listed on the website page located at url_base_to_crawl
        /*
	    $var = fread_url($_GET['url_base_to_crawl']);
	    
	    //http://www.web-max.ca/PHP/misc_23.php
	    preg_match_all ("/a[\s]+[^>]*?href[\s]?=[\s\"\']+".
	                    "(.*?)[\"\']+.*?>"."([^<]+|.*?)?<\/a>/", 
	                    $var, $matches);
	        
	    $matches = $matches[1];
	    $list = array();

	    foreach($matches as $var)
	    {    
	        print($var."<br>");
	    }
        */


	}

 	if(isset($_GET['submitcrawl']) && isset($_GET['url_base_to_crawl'])){
	    $var = fread_url($_GET['url_base_to_crawl']);
	            
	    //http://stackoverflow.com/questions/18093990/php-regex-to-get-all-image-urls-on-the-page	
	    preg_match_all ( '~(http.*\.)(jpe?g|png|[tg]iff?|svg)~i', 
	                    $var, $matches);
	        
	    $matches = $matches[1];
	    $list = array();

	    foreach($matches as $var)
	    {    
	        print($var."<br>");
	    }
	}


// The fread_url function allows you to get a complete
// page. If CURL is not installed replace the contents with
// a fopen / fget loop

	//get hyperlinks from url
    function fread_url($url,$ref="")
    {
        if(function_exists("curl_init")){
            $ch = curl_init();
            $user_agent = "Mozilla/4.0 (compatible; MSIE 5.01; ".
                          "Windows NT 5.0)";
            $ch = curl_init();
            curl_setopt($ch, CURLOPT_USERAGENT, $user_agent);
            curl_setopt( $ch, CURLOPT_HTTPGET, 1 );
            curl_setopt( $ch, CURLOPT_RETURNTRANSFER, 1 );
            curl_setopt( $ch, CURLOPT_FOLLOWLOCATION , 1 );
            curl_setopt( $ch, CURLOPT_FOLLOWLOCATION , 1 );
            curl_setopt( $ch, CURLOPT_URL, $url );
            curl_setopt( $ch, CURLOPT_REFERER, $ref );
            curl_setopt ($ch, CURLOPT_COOKIEJAR, 'cookie.txt');
            $html = curl_exec($ch);
            curl_close($ch);
        }
        else{
            $hfile = fopen($url,"r");
            if($hfile){
                while(!feof($hfile)){
                    $html.=fgets($hfile,1024);
                }
            }
        }
        return $html;
    }
    //http://www.web-max.ca/PHP/misc_23.php






?>



 </body>


</html>
